# StrongSwan Charon Daemon Configuration
# /etc/strongswan.d/charon.conf equivalent

charon {
    # Logging configuration
    filelog {
        /var/log/strongswan.log {
            time_format = %b %e %T
            default = 1
            append = yes
            flush_line = yes
        }
        stderr {
            default = 1
            ike = 2
            cfg = 2
        }
    }
    
    # Network and interface settings
    interfaces_use = eth0                   # Network interface to use
    port = 500                             # IKE port
    port_nat_t = 4500                      # NAT traversal port
    
    # Threading and performance
    threads = 16                           # Number of worker threads
    processor {
        priority_threads {
            high = 3
            medium = 2
            low = 1
        }
    }
    
    # DNS settings
    dns1 = 8.8.8.8                        # Primary DNS
    dns2 = 8.8.4.4                        # Secondary DNS
    
    # Plugin configuration
    plugins {
        # Core plugins
        charon-systemd {
            load = yes
        }
        
        # Cryptographic plugins
        aes {
            load = yes
        }
        sha2 {
            load = yes
        }
        pem {
            load = yes
        }
        x509 {
            load = yes
        }
        openssl {
            load = yes
        }
        
        # Key exchange plugins
        random {
            load = yes
        }
        nonce {
            load = yes
        }
        
        # Authentication plugins
        pubkey {
            load = yes
        }
        psk {
            load = yes
        }
        
        # EAP plugins for additional authentication
        eap-identity {
            load = yes
        }
        eap-md5 {
            load = yes
        }
        
        # Network plugins
        kernel-netlink {
            load = yes
        }
        resolve {
            load = yes
        }
        socket-default {
            load = yes
        }
        
        # Additional useful plugins
        stroke {
            load = yes
        }
        updown {
            load = yes
        }
        
        # XAuth plugin for extended authentication
        xauth-generic {
            load = yes
        }
        
        # DHCP plugin
        dhcp {
            load = yes
        }
        
        # Attribute plugins
        attr {
            load = yes
        }
        attr-sql {
            load = no                      # Disable unless using SQL backend
        }
    }
    
    # Connection management
    keep_alive = 30                        # Keep-alive interval
    max_packet = 10000                     # Maximum packet size
    
    # Certificate validation
    cache_crls = yes                       # Cache Certificate Revocation Lists
    strict_crl_policy = no                 # Relaxed CRL policy for testing
    
    # NAT traversal
    nat_traversal = yes                    # Enable NAT-T
    
    # Security settings
    integrity_test = yes                   # Enable integrity testing
    crypto_test = yes                      # Enable crypto testing
    
    # Load balancing (for multiple servers)
    load_balancing = no                    # Disable for single server setup
    
    # IKE settings
    multiple_authentication = no           # Single authentication per connection
    reuse_ikesa = yes                      # Reuse IKE Security Associations
    
    # ESP settings
    install_routes = yes                   # Install routes automatically
    install_virtual_ip = yes               # Install virtual IPs
    
    # Retransmission settings
    retransmit_tries = 5                   # Number of retransmission attempts
    retransmit_timeout = 4.0               # Initial retransmission timeout
    retransmit_base = 1.8                  # Retransmission backoff factor
}
